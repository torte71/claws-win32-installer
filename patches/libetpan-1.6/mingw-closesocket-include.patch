#! /bin/sh
patch -p1 -f $* < $0
exit $?

diff -ur libetpan-1.6-orig/Makefile.in libetpan-1.6/Makefile.in
--- libetpan-1.6-orig/Makefile.in	2015-05-30 16:12:02.835320937 +0200
+++ libetpan-1.6/Makefile.in	2015-05-30 16:18:16.865373785 +0200
@@ -488,7 +488,7 @@
 # rules defined in rules.mk.
 CLEANFILES = stamp-prepare libetpan-config.h 
 DISTCLEANFILES = libetpan-config
-SUBDIRS = build-windows include src tests doc
+SUBDIRS = build-windows include src doc
 etpaninclude_HEADERS = libetpan-config.h
 all: $(BUILT_SOURCES) config.h
 	$(MAKE) $(AM_MAKEFLAGS) all-recursive
diff -ur libetpan-1.6-orig/src/low-level/imap/mailimap_socket.c libetpan-1.6/src/low-level/imap/mailimap_socket.c
--- libetpan-1.6-orig/src/low-level/imap/mailimap_socket.c	2015-05-30 16:12:02.863321689 +0200
+++ libetpan-1.6/src/low-level/imap/mailimap_socket.c	2015-05-30 16:12:45.032454853 +0200
@@ -53,6 +53,10 @@
 
 #include "mailstream_cfstream.h"
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_IMAP_PORT 143
 #define SERVICE_NAME_IMAP "imap2"
 #define SERVICE_TYPE_TCP "tcp"
diff -ur libetpan-1.6-orig/src/low-level/imap/mailimap_ssl.c libetpan-1.6/src/low-level/imap/mailimap_ssl.c
--- libetpan-1.6-orig/src/low-level/imap/mailimap_ssl.c	2015-05-30 16:12:02.863321689 +0200
+++ libetpan-1.6/src/low-level/imap/mailimap_ssl.c	2015-05-30 16:12:52.264649201 +0200
@@ -53,6 +53,10 @@
 
 #include "mailstream_cfstream.h"
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_IMAPS_PORT 993
 #define SERVICE_NAME_IMAPS "imaps"
 #define SERVICE_TYPE_TCP "tcp"
diff -ur libetpan-1.6-orig/src/low-level/nntp/newsnntp_socket.c libetpan-1.6/src/low-level/nntp/newsnntp_socket.c
--- libetpan-1.6-orig/src/low-level/nntp/newsnntp_socket.c	2015-05-30 16:12:02.875322011 +0200
+++ libetpan-1.6/src/low-level/nntp/newsnntp_socket.c	2015-05-30 16:13:09.985125407 +0200
@@ -51,6 +51,10 @@
 #	include <unistd.h>
 #endif
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_NNTP_PORT 119
 #define SERVICE_NAME_NNTP "nntp"
 #define SERVICE_TYPE_TCP "tcp"
diff -ur libetpan-1.6-orig/src/low-level/nntp/newsnntp_ssl.c libetpan-1.6/src/low-level/nntp/newsnntp_ssl.c
--- libetpan-1.6-orig/src/low-level/nntp/newsnntp_ssl.c	2015-05-30 16:12:02.875322011 +0200
+++ libetpan-1.6/src/low-level/nntp/newsnntp_ssl.c	2015-05-30 16:13:16.865310302 +0200
@@ -50,6 +50,10 @@
 #	include <unistd.h>
 #endif
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_NNTPS_PORT 563
 #define SERVICE_NAME_NNTPS "nntps"
 #define SERVICE_TYPE_TCP "tcp"
diff -ur libetpan-1.6-orig/src/low-level/pop3/mailpop3_socket.c libetpan-1.6/src/low-level/pop3/mailpop3_socket.c
--- libetpan-1.6-orig/src/low-level/pop3/mailpop3_socket.c	2015-05-30 16:12:02.867321796 +0200
+++ libetpan-1.6/src/low-level/pop3/mailpop3_socket.c	2015-05-30 16:13:35.033798558 +0200
@@ -51,6 +51,10 @@
 #endif
 #include <stdlib.h>
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_POP3_PORT 110
 #define SERVICE_NAME_POP3 "pop3"
 #define SERVICE_TYPE_TCP "tcp"
diff -ur libetpan-1.6-orig/src/low-level/pop3/mailpop3_ssl.c libetpan-1.6/src/low-level/pop3/mailpop3_ssl.c
--- libetpan-1.6-orig/src/low-level/pop3/mailpop3_ssl.c	2015-05-30 16:12:02.867321796 +0200
+++ libetpan-1.6/src/low-level/pop3/mailpop3_ssl.c	2015-05-30 16:13:40.481944972 +0200
@@ -51,6 +51,10 @@
 #endif
 #include <stdlib.h>
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_POP3S_PORT 995
 #define SERVICE_NAME_POP3S "pop3s"
 #define SERVICE_TYPE_TCP "tcp"
diff -ur libetpan-1.6-orig/src/low-level/smtp/mailsmtp_socket.c libetpan-1.6/src/low-level/smtp/mailsmtp_socket.c
--- libetpan-1.6-orig/src/low-level/smtp/mailsmtp_socket.c	2015-05-30 16:12:02.867321796 +0200
+++ libetpan-1.6/src/low-level/smtp/mailsmtp_socket.c	2015-05-30 16:13:55.234341439 +0200
@@ -52,6 +52,10 @@
 #	include <unistd.h>
 #endif
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_SMTP_PORT 25
 #define SERVICE_NAME_SMTP "smtp"
 #define SERVICE_TYPE_TCP "tcp"
diff -ur libetpan-1.6-orig/src/low-level/smtp/mailsmtp_ssl.c libetpan-1.6/src/low-level/smtp/mailsmtp_ssl.c
--- libetpan-1.6-orig/src/low-level/smtp/mailsmtp_ssl.c	2015-05-30 16:12:02.867321796 +0200
+++ libetpan-1.6/src/low-level/smtp/mailsmtp_ssl.c	2015-05-30 16:14:00.498482912 +0200
@@ -52,6 +52,10 @@
 #	include <unistd.h>
 #endif
 
+#ifdef HAVE_MINGW32_SYSTEM
+# include <winsock2.h>
+#endif
+
 #define DEFAULT_SMTPS_PORT 465
 #define SERVICE_NAME_SMTPS "smtps"
 #define SERVICE_TYPE_TCP "tcp"
